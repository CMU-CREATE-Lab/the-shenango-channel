<!DOCTYPE html>
<html>
  <head>
    <title>The Shenango Channel</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <style type='text/css'>
      html, body {
        width: 100%;
        height: 100%;
        min-width: 770px;
        min-height: 745px;
        margin: 0;
      }

      #page_container {
        width: 100%;
        height: 100%;
        margin: 0;
        border-spacing: 0;
        border-collapse: collapse;
      }

      #page_container tr:not(.grapher_row) {
        height: 50%;
      }

      .row1 {
        display:table-row;
        height: 50%;
        width: 100%;
        background: white;
      }

      .row1 div {
        display: table-cell;
        width: 100%;
      }

      .row2 {
        display: table-row;
        height: 100%;
        width: 100%;
      }

      .row2 div {
        width: 50%;
        height: 100%;
        background: transparent;
      }

      .row2 div + div {
        background: transparent;
        width: 50%;
        height: 100%;
        position: static;
        top: 0;
        right: 0;
      }

      #map-canvas {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
      }

      #grapher {
        font-size: 10pt !important;
        position: relative;
        width: 100%;
        min-width: 385px;
        height: 100%;
      }

      #dateAxisContainer {
        width: 100%;
        height: 39px;
        position: relative;
      }

      #dateAxis {
        position: absolute;
        right: 250px;
        left: 159px;
        top: 0px;
        height: 38px;
        border: 1px solid black;
        width: 100%;
        background: white;
      }

      .chart {
        height: auto;
        background: #4f5457 !important;
      }

      .chartTitle {
        position: absolute;
        left: 0px;
        width: 136px;
        height: auto;
        border: 1px solid black;
        font-family: 'Helvetica Neue', Helvetica, Arial;
        color: white;
        padding: 11px
      }

      .chartContent {
        position: absolute;
        left: 159px;
        right: 35px;
        height: auto;
        border: 1px solid black;
        background: white;
      }

      .annotationContent {
        position: absolute;
        left: 159px;
        right: 35px;
        height: 35px;
        border: 1px solid black;
        background: white;
      }

      .annotationChart {
        height: 35px;
        background: #4f5457 !important;
      }

      .annotationChartTitle {
        position: absolute;
        left: 0px;
        width: 136px;
        height: 35px;
        border: 1px solid black;
        font-family: 'Helvetica Neue', Helvetica, Arial;
        color: white;
        padding: 11px
      }

      .chartAxis {
        position: absolute;
        right: 0px;
        width: 34px;
        height: 100%;
        border: 1px solid black;
        background: white;
      }

      #sensorColumnTitle {
        background: rgb(214, 208, 208);
        padding-left: 12px;
        text-decoration: underline;
        font-size: 15px;
        border-top: 1px solid black;
        width: 160px;
      }

      #tabs {
        border: 0px;
      }

      .ui-tabs-nav {
        border: 0px !important;
        background: #9A9A9A !important;
        border-radius: 0px !important;
        font-size: 15px !important;
        padding: 0px !important;
      }

      .ui-tabs-nav .ui-state-default {
        background: #E2E2E2 !important;
      }

      .ui-tabs-nav .ui-tabs-active {
        background: white  !important;
      }

      .ui-tabs-nav li {
        margin: 0px 0px -1px 0px !important;
        border-right: 1px solid #9C9494 !important;
        border-top: 1px solid #9C9494 !important;
        border-left: 1px solid #9C9494 !important;
      }

      #tutorialDialog {
        width: 100%;
        height: 100%;
        display: none;
        overflow: hidden;
      }

      .tutorialButton {
        position: absolute !important;
        height: 31px !important;
        top: 29px !important;
        width: 109px !important;
        left: 89px !important;
        color: white !important;
        background: rgb(215,84,90) !important;
        border: 2px solid #fff !important;
        border-radius: 1px !important;
        box-shadow: 2px 2px 3px rgba(0,0,0,0.3) !important;
        z-index: 100 !important;
        outline: none !important;
        font-family: Arial, Helvetica, sans-serif !important;
        font-size: 11px !important;
      }

      .tutorialButton .ui-icon.ui-icon-custom-tutorialButton {
        background-image: none !important;
        width: 34px !important;
        height: 34px !important;
        opacity: 0.55 !important;
        background-size: contain !important;
        margin-left: -17px !important;
        margin-top: -17px !important;
      }

      .tutorialButton .ui-button-text {
        margin-left: -14px !important;
        font-size: 15px !important;
        margin-top: 2px !important;
        line-height: 15px!important;
        text-align: left !important;
      }

      .zoomGrapherBtn {
        background: rgb(150,150,150) !important;
        border-radius: 0px !important;
        outline: none;
        font-family: Arial, Helvetica, sans-serif !important;
        font-size: 11px !important;
        border: 4px solid white !important;
      }

      .zoomGrapherBtn:hover {
        background: rgb(100,100,100) !important;
      }

      #zoomGrapherIn {
        position: absolute;
        top: 1px;
        right: 0px;
        height: 38px;
        width: 34px;
      }

      #zoomGrapherOut {
        position: absolute;
        top: 35px;
        right: 0px;
        height: 38px;
        width: 34px;
      }

      #tab3-intro-text {
        padding-left: 25%;
        padding-right: 25%;
        padding-bottom: 10px;
        font-size: 16px;
      }

      #tab3-header {
        padding-top: 10px;
        text-align: center;
      }

      #flickr-feed {
        width: 100%;
        height: 550px;
      }

      .galleria-info-link {
        display: none;
      }

      .galleria-theme-classic .galleria-info-text {
        display: block;
      }

      .galleria-theme-classic .galleria-info {
        width: 200px;
      }

      #galleria {
        height: 550px;
      }

    </style>

    <link href="assets/timemachine-viewer/css/jquery-ui/smoothness/jquery-ui.custom.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="assets/timemachine-viewer/css/defaultUI.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="assets/timemachine-viewer/css/timelineMetadataVisualizer.css" rel="stylesheet" type="text/css"/>
    <link href="assets/css/application.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="assets/timemachine-viewer/libs/change-detect/css/change.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="assets/galleria/themes/classic/galleria.classic.min.css" rel="stylesheet" type="text/css"/>

    <script src="assets/timemachine-viewer/js/jquery/jquery.min.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/jquery/jquery-ui.custom.min.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/jquery/plugins/mouse/jquery.mousewheel.min.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/org/gigapan/util.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/org/gigapan/timelapse/videoset.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/org/gigapan/timelapse/parabolicMotion.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/org/gigapan/timelapse/timelapse.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/Math.uuid.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/org/gigapan/timelapse/snaplapse.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/org/gigapan/timelapse/snaplapseViewer.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/org/gigapan/timelapse/defaultUI.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/org/gigapan/timelapse/crossdomain_api.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/js/org/gigapan/timelapse/timelineMetadataVisualizer.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/template_includes.js" type="text/javascript"></script>

    <script src="assets/timemachine-viewer/libs/change-detect/js/ThumbnailServiceAPI.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/libs/change-detect/js/TimeMachineCanvasLayer.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/libs/change-detect/js/ThumbnailTool.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/libs/change-detect/js/BoxEventHandler.js" type="text/javascript"></script>
    <script src="assets/timemachine-viewer/libs/change-detect/js/ChangeDetectionTool.js" type="text/javascript"></script>

    <script src="http://tiles.cmucreatelab.org/ecam/timemachines/shenango1/shenango1.js" type="text/javascript"></script>
    <script src="assets/js/jquery.xdomainrequest.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7Rt5Wm2f-3Ev1P6lP_kqMJqMrINOl3oM"></script>
    <script src="assets/grapher/grapher2.nocache.js" type="text/javascript"></script>
    <script src="map.js"></script>
    <script src="smell.js"></script>
    <script src="assets/data-visualization-tools/js/CanvasLayer.js"></script>

    <script src="assets/galleria/galleria-1.5.7.min.js"></script>
    <script src="assets/galleria/plugins/flickr/galleria.flickr.min.js"></script>

    <script>
      "use strict";
      jQuery.support.cors = true;
      var zoomify, locationDivId, timelapse, timelapseFeedUnavailable, hashVars, dateAxis;
      var currentDate = (new Date());
      var currentDateString = currentDate.getFullYear() + "-" + padDigits((currentDate.getMonth() + 1), 2) + "-" + padDigits(currentDate.getDate(), 2);
      var series = [];
      var currentLocation = "shenango1";
      var currentDate;
      var ESDR_API_ROOT_URL = 'http://esdr.cmucreatelab.org/api/v1';
      var clampTimeout = null;
      var fixedCursorPosition;
      var tmpCount = 0;
      var grapherReady = false;
      var grapherLoadedInterval = null;
      var showSmokeDetection = true;

      var esdr_feeds = {
        ACHD_Avalon : {
          feed_id: 1,
          coordinates : {
            latitude: 40.499767,
            longitude: -80.072
          },
          api_key: "8a2ce5c845ca323d80056aefd564f6f7305724a0476318e488c5ea380094ebc2",
          requested_day: {},
          channels : {
            "PM25B_UG_M3": {
              show_graph: true,
              hourly : true,
              graphMetaData : {
                label: "ACHD: Avalon - PM<sub>2.5</sub>, &mu;g/m<sup>3</sup>",
                color: "10,104,177"
              },
              summary: {}
            },
            "SONICWS_MPH": {
              show_graph: false,
              hourly : true,
              summary: {}
            },
            "SONICWD_DEG": {
              show_graph: false,
              hourly : true,
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        ACHD_Avalonb : {
          feed_id: 1,
          coordinates : {
            latitude: 40.499767,
            longitude: -80.072
          },
          isDouble: true,
          api_key: "8a2ce5c845ca323d80056aefd564f6f7305724a0476318e488c5ea380094ebc2",
          requested_day: {},
          channels : {
            "PM25T_UG_M3": {
              show_graph: true,
              hourly : true,
              graphMetaData : {
                label: "ACHD: Avalon - PM<sub>2.5</sub>, &mu;g/m<sup>3</sup>",
                color: "10,104,177"
              },
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        Speck1 : {
          feed_id: 5332,
          coordinates : {
            latitude: 40.499767,
            longitude: -80.068
          },
          requested_day: {},
          api_key: "b05e15a31711c80542d3db0fc3f5e63590638052ffa121732df9c776316c5d89",
          channels: {
            particle_concentration : {
              show_graph: true,
              graphMetaData : {
                label: "Avalon Speck - <br> PM<sub>2.5</sub>, &mu;g/m<sup>3</sup>",
                color: "127, 57, 148"
              },
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        Speck1b : {
          feed_id: 5333,
          coordinates : {
            latitude: 40.499767,
            longitude: -80.068
          },
          isDouble: true,
          requested_day: {},
          api_key: "d4f535777752957c32a004d89a8c7136b95c7330dd66e9a6f65e2bd9e665bc38",
          channels: {
            particle_concentration : {
              show_graph: true,
              graphMetaData : {
                label: "Avalon Speck - <br> PM<sub>2.5</sub>, &mu;g/m<sup>3</sup>",
                color: "127, 57, 148"
              },
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        Speck2 : {
          feed_id: 4617,
          coordinates : {
            latitude: 40.501,
            longitude: -80.061
          },
          requested_day: {},
          api_key: "3c9286797e517dacd885309bb8e88a1309a9bdd0e7655bcfa1c47fa47f7c7b76",
          channels: {
            particle_concentration : {
              show_graph: true,
              graphMetaData : {
                label: "Bellevue Speck - PM<sub>2.5</sub>, &mu;g/m<sup>3</sup>",
                color: "27, 141, 52"
              },
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        Speck2b : {
          feed_id: 4711,
          coordinates : {
            latitude: 40.501,
            longitude: -80.061
          },
          isDouble: true,
          requested_day: {},
          api_key: "39c80375a56564c06c9faea157aeeecdded2ac5bc2cc14c812cab23682af16f4",
          channels: {
            particle_concentration : {
              show_graph: true,
              graphMetaData : {
                label: "Bellevue Speck 2 - PM<sub>2.5</sub>, &mu;g/m<sup>3</sup>",
                color: "27, 141, 52"
              },
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        Speck3 : {
          feed_id: 4316,
          coordinates : {
            latitude: 40.508,
            longitude: -80.076
          },
          requested_day: {},
          api_key: "02e22d5b3a81370d60d265d9ae9e61e1ddbb276f5aafe894c5f7de424e849147",
          channels: {
            particle_concentration : {
              show_graph: true,
              graphMetaData : {
                label: "Ben Avon Speck - PM<sub>2.5</sub>, &mu;g/m<sup>3</sup>",
                color: "230, 120, 26"
              },
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        Speck3b : {
          feed_id: 4616,
          coordinates : {
            latitude: 40.508,
            longitude: -80.076
          },
          isDouble: true,
          requested_day: {},
          api_key: "6371248f9710d694e92591f4f44ff339bf40907d3faf34e5ad85f2e69483fd74",
          channels: {
            particle_concentration : {
              show_graph: true,
              graphMetaData : {
                label: "Ben Avon Speck 2 - PM<sub>2.5</sub>, &mu;g/m<sup>3</sup>",
                color: "230, 120, 26"
              },
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        ACHD_North_Braddock : {
          feed_id: 3,
          coordinates : {
            latitude: 40.402,
            longitude: -79.860
          },
          requested_day: {},
          api_key: "3c607ed62b70fd874e62c8aea4c40811398c6ddcf5dc3e15edfc4cda4dc256d6",
          channels: {
            "SONICWS_MPH": {
              show_graph: false,
              hourly : true,
              summary: {}
            },
            "SONICWD_DEG": {
              show_graph: false,
              hourly : true,
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        ACHD_Lawrenceville : {
          feed_id: 26,
          coordinates : {
            latitude: 40.465,
            longitude: -79.960
          },
          requested_day: {},
          api_key: "01aceb2dd35a61aadb5992292ee7cc34ec8d044ccf8d49b4b24c9c335476616c",
          channels: {
            "SONICWS_MPH": {
              show_graph: false,
              hourly : true,
              summary: {}
            },
            "SONICWD_DEG": {
              show_graph: false,
              hourly : true,
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        ACHD_Parkway_East : {
          feed_id: 43,
          coordinates : {
            latitude: 40.437,
            longitude: -79.863
          },
          requested_day: {},
          api_key: "bf61b67e0b93d612dacf8f9f034fba75da9141046df38fd058b44fdb1076ab9f",
          channels: {
            "SONICWS_MPH": {
              show_graph: false,
              hourly : true,
              summary: {}
            },
            "SONICWD_DEG": {
              show_graph: false,
              hourly : true,
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        ACHD_Liberty : {
          feed_id: 28,
          coordinates : {
            latitude: 40.323,
            longitude: -79.868
          },
          requested_day: {},
          api_key: "ce7e8af4e53980642fd0249808af4f55bcfb00744207106a5b000119a0c5e189",
          channels: {
            "SONICWS_MPH": {
              show_graph: false,
              hourly : true,
              summary: {}
            },
            "SONICWD_DEG": {
              show_graph: false,
              hourly : true,
              summary: {}
            }
          },
          fullTimeRange: {}
        },
        ACHD_South_Fayette : {
          feed_id: 32,
          coordinates : {
            latitude: 40.375,
            longitude: -80.169
          },
          requested_day: {},
          api_key: "fd7a17dee775a42a97a0a87d9ba504a172e1fe46b466f8ae2972df1dcf105b7c",
          channels: {
            "SONICWS_MPH": {
              show_graph: false,
              hourly : true,
              summary: {}
            },
            "SONICWD_DEG": {
              show_graph: false,
              hourly : true,
              summary: {}
            }
          },
          fullTimeRange: {}
        }
      };

      if (showSmokeDetection) {
        esdr_feeds.Smoke_Detection = {
          feed_id: 5494,
          requested_day: {},
          api_key: "22075ad630b1f674e7f1da7f3de77b5abeea89f95e9c6c8868eef6cf0cd312b1",
          channels: {
            smoke_level : {
              show_graph: true,
              graphMetaData : {
                label: "Smoke Detection",
                color: "93,93,93"
              },
              summary: {}
            }
          },
          fullTimeRange: {}
        };
      }

      function tm_init() {
        selectTimelapseFeed();

        var initialDataset = cached_breathecam.latest.path;
        var startingDate = cached_breathecam.latest.date;

        var hash = window.location.hash.slice(1);
        hashVars = org.gigapan.Util.unpackVars(hash);

        var loadedTimelapse = false;
        if (hashVars) {
          if (hashVars.d) {
            startingDate = String(hashVars.d);
            initialDataset = cached_breathecam.datasets[startingDate];
            if (!initialDataset) {
              initialDataset = cached_breathecam.latest.path;
            }
          }
          if (hashVars.s) {
            loadedTimelapse = true;
            currentLocation = String(hashVars.s);
            changeLocation(currentLocation, startingDate, null, null, false, function() {
              initialDataset = cached_breathecam.datasets[startingDate];
              if (!initialDataset) {
                initialDataset = cached_breathecam.latest.path;
              }
              setupTimelapse(initialDataset, startingDate);
            });
          }
        }

        // If we did not load the timelapse with the hash vars above, do so now.
        if (!loadedTimelapse)
          setupTimelapse(initialDataset, startingDate);
      }

      function img_init() {
        zoomify = new org.gigapan.zoomify({
          onImageReady: function(imgId) {
            showContent();
            if (!$("#timelapse_feed").is(':visible')) {
              selectImageFeed();
            }
          }
        });

        $("#stitched_image").load(function() {
          zoomify.makeImageZoomable("stitched_image");
        });

        $("#stitched_image").bind("mouseover mouseup", function() {
          $(this).removeClass("openHand closedHand").addClass("openHand");
        }).bind("mousedown", function() {
          $(this).removeClass("openHand closedHand").addClass("closedHand");
        });
      }

      function setupTimelapse(initialDataset, startingDate) {
        var settings = {
          url: initialDataset,
          disableTourLooping: true,
          mediaType: ".mp4",
          showFullScreenBtn: false,
          showLogoOnDefaultUI: false,
          datasetType: "breathecam",
          showThumbnailTool: true,
          enableTimelineMetadataVisualizer: true,
          onTimeMachinePlayerReady: function(viewerDivId) {
            createTutorialButton(720, 540, "#timeMachine");
            if (canvasLayer)
              repaintCanvasLayer();
            if (smellCanvasLayer)
              repaintSmellCanvasLayer();
            // Time Machine Listeners
            timelapse.addTimeChangeListener(function(videoTime) {
              if (dateAxis) {
                fixedCursorPosition = Date.parse(timelapse.getCurrentCaptureTime().replace(/-/g, "/")) / 1000;
                dateAxis.setCursorPosition(fixedCursorPosition);
              }
              if (canvasLayer)
                repaintCanvasLayer();
              if (smellCanvasLayer)
                repaintSmellCanvasLayer();
            });
            // Override the hashchange event
            window.onhashchange = null;
            $(window).on("hashchange", function() {
              var newHash = window.location.hash.slice(1);
              var newHashVars = org.gigapan.Util.unpackVars(newHash);
              var currentHash = timelapse.getShareView();
              var currentHashVars = org.gigapan.Util.unpackVars(currentHash);
              window.location.hash = "";

              if (!newHashVars) return;

              if ((newHashVars.d && currentHashVars.d != newHashVars.d) || (newHashVars.s && currentHashVars.s != newHashVars.s)) {
                var newDate, newDataset;
                if (newHashVars.d) {
                  newDate = String(newHashVars.d);
                  newDataset = cached_breathecam.datasets[newDate];
                  if (!newDataset) return;
                }
                var newTime = parseFloat(newHashVars.t);
                var newView = timelapse.normalizeView(timelapse.unsafeViewToView(newHashVars.v));
                if (newHashVars.s && currentHashVars.s != newHashVars.s) {
                  currentLocation = String(newHashVars.s);
                  changeLocation(currentLocation, newDate, newView, newTime, true);
                } else {
                  updateCalendarAndToggleUI(newDate);
                  timelapse.loadTimelapse(newDataset, newView, newTime, false);
                }
              } else {
                // Share views
                timelapse.loadSharedViewFromUnsafeURL("#" + newHash);
              }
            });
            if (!hashVars) {
              var numFrames = timelapse.getNumFrames();
              // 12 fps * 5 seconds = 60 frames
              var fiveSecondsFromEnd = numFrames - 60;
              timelapse.seekToFrame(fiveSecondsFromEnd);
            }
            showContent();
            // Share view
            var hash = window.location.hash.slice(1);
            timelapse.loadSharedViewFromUnsafeURL("#" + hash);
          }
        };
        timelapse = new org.gigapan.timelapse.Timelapse("timeMachine", settings);

        loadCalendar(startingDate);
      }

      function hideSmokeDetectionGraph() {
        $('*[data-channel="smoke_level"]').hide();
        setSizes();
      }

      function showSmokeDetectionGraph() {
        $('*[data-channel="smoke_level"]').show();
        setSizes();
      }

      function moveTimelineMetadataVisualizerUI() {
        var $target = $('*[data-channel="smoke_level"]').find('div')[0];
        $(".fastforwardButton").appendTo($target).css({
          "position" : "relative",
          "margin-top" : "2px"
        });
        $(".metadataImgsButton").appendTo($target).css({
          "position" : "relative",
          "margin-left" : "5px",
          "margin-top" : "2px"
        });
      }

      function loadMetaData(date, datasetName) {
        $.ajax({
          dataType: "json",
          url: "http://tiles.cmucreatelab.org/ecam/timemachines/smoke_detection/" + datasetName + "/smoke-" + date + ".json",
          success: function(json) {
            moveTimelineMetadataVisualizerUI();
            timelapse.getTimelineMetadataVisualizer().loadMetaData(json);
            timelapse.getTimelineMetadataVisualizer().showControlUI();
            showSmokeDetectionGraph();
          },
          error: function() {
            timelapse.getTimelineMetadataVisualizer().hideControlUI();
            hideSmokeDetectionGraph();
          }
        });
      }

      function selectTimelapseFeed() {
        $("#image_feed").css("visibility", "hidden");
        $("#stitched_image_wrapper").css("visibility", "hidden");
        $("#stitched_image").css("visibility", "hidden");
        $("#timelapse_feed").show();
        setLocationTitle();
      }

      function selectImageFeed() {
        $("#timelapse_feed").hide();
        $("#image_feed").css("visibility", "visible");
        $("#stitched_image_wrapper").css("visibility", "visible");
        $("#stitched_image").css("visibilriity", "visible");
        $("#location_toggle_container").css("top", "0px");
        setLocationTitle();
      }

      function setLocationTitle() {
        var locationTitle = $("#location_toggle_container .location_thumbnail_selected").siblings(".location_title").text();
        $("#locationTitle").text(locationTitle);
      }

      function showContent() {
        $("#loading").hide();
        $("#content").css("visibility", "visible");
      }

      function changeLocation(locationName, newDate, newView, newTime, doLoad, callBack, newTimeAsDateObj) {
        currentLocation = locationName;
        if (timelapseFeedUnavailable) {
          location.href = "/embeds/" + locationName;
        } else {
          $.ajax({
            url: "http://tiles.cmucreatelab.org/ecam/timemachines/" + locationName + "/" + locationName + ".json",
            dataType: "json"
          }).done(function(data) {
            cached_breathecam = data;
            var startingDate = cached_breathecam.latest.date;
            var startingDataset = cached_breathecam.latest.path;

            if (newDate) {
              var tmpStartingDataset = cached_breathecam.datasets[newDate];
              if (tmpStartingDataset) {
                startingDate = newDate;
                startingDataset = tmpStartingDataset;
              }
            }
            // If there is no timelapse object at this point, then that means that we have just arrived at the page
            // with a share link that has an invalid location name.
            // Load the timelapse with the default location specified in the .fail() callback below.
            updateCalendarAndToggleUI(startingDate);
            if (!timelapse) {
              setupTimelapse(startingDataset, startingDate);
              return;
            }
            setGraphTimeRange(startingDate);
            if (doLoad) {
              if (timelapse && startingDataset) {
                newTime = parseFloat(newTime);
                timelapse.loadTimelapse(startingDataset, newView, newTime, false, newTimeAsDateObj, function() {
                  if (!newTimeAsDateObj && isNaN(newTime)) {
                    var numFrames = timelapse.getNumFrames();
                    // 12 fps * 5 seconds = 60 frames
                    var fiveSecondsFromEnd = numFrames - 60;
                    timelapse.seekToFrame(fiveSecondsFromEnd);
                  }
                });
              }
            } else if (typeof(callBack) === "function") {
              callBack();
            }
          }).fail(function(jqXHR, textStatus, errorThrown) {
            console.log(jqXHR, textStatus, errorThrown);
            changeLocation("shenango1", null, null, null, true);
          });
        }
      }

      function updateCalendarAndToggleUI(startingDate) {
        $(".gwt-PopupPanel").remove();
        locationDivId = currentLocation + "_overlay";
        setLocationThumbnailToggle();
        setLocationTitle();
        $("#datepicker").datepicker("destroy");
        loadCalendar(startingDate);
      }

      function loadCalendar(startingDate) {
        currentDate = startingDate;
        var dateArray = startingDate.split("-");
        $("#datepicker").datepicker({
          defaultDate : new Date(dateArray[0], dateArray[1] - 1, dateArray[2]),
          minDate : new Date(2014, 0),
          onSelect : selectDay,
          beforeShowDay : highlightDays
        });
      }

      function highlightDays(date) {
        date = $.datepicker.formatDate('yy-mm-dd', date);
        if (cached_breathecam.datasets[date])
          return [true, 'date-highlight'];
        else
          return [false, ''];
      }

      function selectDay(dateText, dateElem) {
        var date = $.datepicker.formatDate('yy-mm-dd', new Date(dateText));
        var path = cached_breathecam.datasets[date];
        if (timelapse && path) {
          $(".gwt-PopupPanel").remove();
          currentDate = date;
          setGraphTimeRange(date);
          timelapse.loadTimelapse(path, null, null, true);
        }
      }

      function setLocationThumbnailToggle() {
        $(".location_thumbnail_selected").removeClass("location_thumbnail_selected");
        $("#" + locationDivId).addClass("location_thumbnail_selected");
      }

      function getFormattedTime(date) {
        var hours = date.getHours() === 0 ? "12" : date.getHours() > 12 ? date.getHours() - 12 : date.getHours();
        var minutes = (date.getMinutes() < 10 ? "0" : "") + date.getMinutes();
        var seconds = date.getSeconds();
        var ampm = date.getHours() < 12 ? "AM" : "PM";
        var formattedTime = hours + ":" + minutes + ":" + seconds + " " + ampm;
        return formattedTime;
      }

      function requestEsdrExport(requestInfo, callBack) {
        $.ajax({
          crossDomain: true,
          type: "GET",
          dataType: "text",
          url: ESDR_API_ROOT_URL + "/feeds/" + requestInfo.feed_id + "/channels/" + requestInfo.channels + "/export",
          data: { from: requestInfo.start_time, to: requestInfo.end_time, FeedApiKey: requestInfo.api_key},
          success: function(csvData) {
            if (typeof(callBack) === "function")
              callBack(csvData);
          },
          failure: function(data) {
            console.log('Failed to load sensor data.');
          },
          headers: requestInfo.headers
        });
      }

      function parseEsdrCSV(csvData, sensor) {
        var csvArray = csvData.split("\n");
        var headingsArray = csvArray[0].split(",");
        // First row is the CSV headers, which we took care of above, so start at 1.
        for (var i = 1; i < csvArray.length; i++) {
          var csvLineAsArray = csvArray[i].split(",");
          // First entry is the EPOC time, so start at index 1.
          for (var j = 1; j < csvLineAsArray.length; j++) {
            var tmpChannelHeading = headingsArray[j].split(".");
            var channelHeading = tmpChannelHeading[tmpChannelHeading.length - 1];
            var timeStamp = sensor.channels[channelHeading].hourly ? (csvLineAsArray[0] - 1800): csvLineAsArray[0];
            sensor.channels[channelHeading].summary[timeStamp] = parseFloat(csvLineAsArray[j]);
          }
        }
      }

      function padDigits(number, digits) {
        return Array(Math.max(digits - String(number).length + 1, 0)).join(0) + number;
      }

      var createChart = function(feed, channelName, feedAPIKey) {
        var startTime = feed.fullTimeRange.min;
        var endTime = feed.fullTimeRange.max;

        // Initial creation
        if (!$("#dateAxisContainer").length) {
          $("#grapher").append('<tr id="dateAxisContainer" class="grapher_row"><td id="sensorColumnTitle">Location / Sensor</td><td id="dateAxis"></td><td></td></tr>');
          dateAxis = new DateAxis("dateAxis", "horizontal", {
            min: startTime,
            max: endTime
          });

          // Create zooming buttons
          $("#grapher").append('<button id="zoomGrapherIn" class="zoomGrapherBtn" title="Zoom in the graphs"></button>');
          $("#grapher").append('<button id="zoomGrapherOut" class="zoomGrapherBtn" title="Zoom out the graphs"></button>');
          $("#zoomGrapherIn").button({
            icons: {
              secondary: "ui-icon-custom-plus-white"
            },
            text: false
          }).on("click", function() {
            zoomGrapher(0.7);
          });
          $("#zoomGrapherOut").button({
            icons: {
              secondary: "ui-icon-custom-minus-white"
            },
            text: false
          }).on("click", function() {
            zoomGrapher(1.3);
          });

          dateAxis.setCursorColor("#1A1A1A");
          dateAxis.addAxisChangeListener(function(e) {
            // Boo, grapher hacks abound...
            var $gwtPopupPanels = $(".gwt-PopupPanel");
            if ($gwtPopupPanels.length && (fixedCursorPosition < dateAxis.getMin() || fixedCursorPosition > dateAxis.getMax())) {
              $gwtPopupPanels.each(function() {
                if ($(this).text() == gwtPopUpText) {
                  $(this).hide();
                } else if ($gwtPopupPanels.length == 1) {
                  $(this).show();
                }
              });
            }
            if (e) {
              var cursorPosition = e.cursorPosition;
              if (fixedCursorPosition != cursorPosition) {
                // Reset the cursor position
                dateAxis.setCursorPosition(fixedCursorPosition);
              }
            }
            if (clampTimeout) return;
            clampTimeout = window.setTimeout(function() {
              for (var seriesCount = 0; seriesCount < series.length; seriesCount++) {
                var plots = series[seriesCount].p;
                clampNumberAxisToDataRange(plots, seriesCount);
              }
              window.clearTimeout(clampTimeout);
              clampTimeout = null;
            }, 150);
          });
          dateAxis.setMaxRange(null, endTime);
          addSmellReportsToGrapher();
          if (timelapse) {
            var currentCaptureTime = timelapse.getCurrentCaptureTime();
            if (currentCaptureTime) {
              fixedCursorPosition = Date.parse(currentCaptureTime.replace(/-/g, "/")) / 1000;
              dateAxis.setCursorPosition(fixedCursorPosition);
            }
          }
        }

        // Set max range of all the graphs
        if (endTime > dateAxis.getMax()) {
          dateAxis.setMaxRange(null, endTime);
        }

        setGraphTimeRange(currentDateString);

        // Add charts
        var seriesIdx = series.length;
        var color_line = "rgb(" + feed.channels[channelName].graphMetaData.color + ")";
        var color_fill = "rgba(" + feed.channels[channelName].graphMetaData.color + ",1)";

        if (feed.feed_id == 1 && channelName == "PM25T_UG_M3") {
          seriesIdx = 1;
        } else if (feed.feed_id == 5333) {
          seriesIdx = 2;
        } else if (feed.feed_id == 4711) {
          seriesIdx = 3;
        } else if (feed.feed_id == 4616) {
          seriesIdx = 4;
        } else {
          series[seriesIdx] = {};
          series[seriesIdx].id = seriesIdx;
          var row = $('<tr class="chart grapher_row"' + 'data-channel=' + channelName + '></tr>');
          row.append('<td class="chartTitle" style="background:' + color_fill + '"><div>' + feed.channels[channelName].graphMetaData.label + '</div></td>');
          row.append('<td id="series' + seriesIdx + '" class="chartContent"></td>');
          row.append('<td id="series' + seriesIdx + 'axis" class="chartAxis"></td>');
          $('#grapher').append(row);
          series[seriesIdx].axis = new NumberAxis('series' + seriesIdx + 'axis', "vertical");
          if (showSmokeDetection && channelName == "smoke_level") {
            hideSmokeDetectionGraph();
            loadMetaData(currentDate, currentLocation);
            timelapse.addDatasetLoadedListener(function() {
              loadMetaData(currentDate, currentLocation);
            });
          }
        }

        var datasource;
        (function(source) {
          datasource = function(level, offset, successCallback, failureCallback) {
            $.ajax({
              type: "GET",
              dataType: "json",
              url: ESDR_API_ROOT_URL + "/feeds/" + feedAPIKey + "/channels/" + source + "/tiles/" + level + "." + offset,
              success: function(json) {
                if(showSmokeDetection && channelName=="smoke_level") {
                  // Set max smoke reading value
                  var max_smoke_value = 300;
                  for (var i=0; i<json.data.data.length; i++) {
                    if(json.data.data[i][1]>max_smoke_value) {
                      json.data.data[i][1] = max_smoke_value;
                    }
                  }
                }
                successCallback(JSON.stringify(json.data));
              },
              failure: failureCallback
            });
          };
        })(channelName);
        var plot = new DataSeriesPlot(datasource, dateAxis, series[seriesIdx].axis, {});

        plot.addDataPointListener(function(pointData, event) {
          if (!event) return;
          if (event.actionName == "click") {
            fixedCursorPosition = pointData.date;
            var pointDataDateObj = new Date(pointData.dateString.split(".")[0]);
            var commentDate = $.datepicker.formatDate('yy-mm-dd', pointDataDateObj);
            if (commentDate != currentDate) {
              var path = cached_breathecam.datasets[commentDate];
              if (!path) return;
              var currentView = timelapse.getView();
              currentDate = commentDate;
              timelapse.loadTimelapse(path, currentView, null, null, pointDataDateObj);
              $("#datepicker").datepicker("setDate", pointDataDateObj);
            } else {
              var desiredDateString = pointData.dateString.split(", ")[1];
              var closestDesiredFrame = timelapse.findExactOrClosestCaptureTime(desiredDateString.substr(0, 8));
              timelapse.seekToFrame(closestDesiredFrame);
            }
          }
        });

        var cursorColor = (feed.isDouble) ? "rgba(0,0,0,0)" : "#2A2A2A";
        plot.setStyle({
          "cursor" : {
            "color" : cursorColor,
            "lineWidth" : 1
          },
          "styles": [
            { "type" : "line", "lineWidth" : 1, "show" : true, "color" : color_line }/*,
            { "type" : "circle", radius : 1, "lineWidth" : 1, "show" : true, "color" : color_line, fill : true }*/
          ],
          "highlight" : {
            "lineWidth" : 1,
            "styles" : [
               {
                  "type" : "circle",
                  radius : 3.5,
                  "lineWidth" : 0.5,
                  "show" : true,
                  "color" : "#2A2A2A",
                  fill : true,
                  fillColor: "#2A2A2A"
               },
               {
                  "show" : true,
                  "type" : "value",
                  "fillColor" : "#000000",
                  "marginWidth" : 10,
                  "font" : "12pt Helvetica,Arial,Verdana,sans-serif",
                  "verticalOffset" : 5,
                  "horizontalOffset" : 12,
                  "numberFormat" : "###,##0.#"
               }
            ]
          }
        });

        if (feed.isDouble) {
          series[seriesIdx].pc.addPlot(plot);
        } else {
          series[seriesIdx].p = [];
          series[seriesIdx].pc = new PlotContainer("series" + seriesIdx, false, [plot]);
        }
        series[seriesIdx].p.push(plot);

        setSizes();

        var plotIdx = series[seriesIdx].p.length - 1;
        if (!series[seriesIdx].loadingIntervalCounts) {
          series[seriesIdx].loadingIntervalCounts = {};
          series[seriesIdx].checkPlotLoadedIntervals = {};
        }
        series[seriesIdx].loadingIntervalCounts[plotIdx] = 0;
        series[seriesIdx].checkPlotLoadedIntervals[plotIdx] = setInterval(function(){
          clampNumberAxisToDataRange(series[seriesIdx].p, seriesIdx);
          series[seriesIdx].loadingIntervalCounts[plotIdx]++;
        }, 100);

      };

      function clampNumberAxisToDataRange(plots, seriesIdx) {
        var stats, tmp_stats, min = 9999, max = -9999;
        if (!plots) return;
        if (plots.constructor === Array) {
          for (var i = 0; i < plots.length; i++) {
            if (series[seriesIdx].loadingIntervalCounts && series[seriesIdx].loadingIntervalCounts[i] >= 20) {
              clearInterval(series[seriesIdx].checkPlotLoadedIntervals[i]);
            }
            tmp_stats = plots[i].getSimpleStatistics(dateAxis.getMin(), dateAxis.getMax());
            if (tmp_stats.count > 0) {
              stats = tmp_stats;
              if (min > stats.y_min) min = stats.y_min;
              if (max < stats.y_max) max = stats.y_max;
            }
          }
        } else {
          if (series[seriesIdx].loadingIntervalCounts && series[seriesIdx].loadingIntervalCounts[0] >= 20) {
            clearInterval(series[seriesIdx].checkPlotLoadedIntervals[0]);
          }
          stats = plots.getSimpleStatistics(dateAxis.getMin(), dateAxis.getMax());
          min = stats.y_min;
          max = stats.y_max;
        }

        if (stats && stats.has_data && typeof stats.y_min !== 'undefined' && typeof stats.y_max !== 'undefined') {
          var paddedRange = paddedYAxisRange(min, max);
          series[seriesIdx].axis.setRange(paddedRange.min, paddedRange.max);
        }
      }

      function zoomGrapher(scale) {
        var min_time = dateAxis.getMin();
        var max_time = dateAxis.getMax();
        var mean_time = (max_time+min_time)/2;
        var range_half_scaled = scale*(max_time-min_time)/2;
        dateAxis.setRange(mean_time-range_half_scaled,mean_time+range_half_scaled);
      }

      function paddedYAxisRange(min, max) {
        var yDiff = max - min;
        var padding = 0.5;
        if (yDiff < 1e-10) {
          padding = 0.5;
        } else {
          padding = 0.05 * yDiff;
        }
        return {min : min - padding, max : max + padding};
      }

      function setSizes() {
        var width = $(window).width() / 2;
        var height = $(window).height() / 2;
        if (!dateAxis) return;
        //$("#grapher").css({"width" : width + "px", "height" : height + "px"});
        $("#dateAxis").width($('.chartContent').width());
        var dateAxisWidth = $('#dateAxis').width();
        var dateAxisHeight = $('#dateAxis').height();
        $('.chartContent').height($('.chart').height() - 1);
        $('.chartTitle').height($('.chart').height() - 23);
        $('.chartAxis').height($('.chart').height() - 1);
        if (!dateAxisWidth || !dateAxisHeight) return;
        dateAxis.setSize(dateAxisWidth, dateAxisHeight, SequenceNumber.getNext());
        for (var i = 0; i < series.length; i++) {
          var newHeight = $('.chart').height();
          if (i === 0)
            newHeight = $('.annotationContent').height();
          if (series[i].axis)
            series[i].axis.setSize($('#series' + i + 'axis').width(), newHeight, SequenceNumber.getNext());
          if (series[i].pc)
            series[i].pc.setSize($('#series' + i).width(), newHeight, SequenceNumber.getNext());
        }
      }

      function setGraphTimeRange(date) {
        if (!dateAxis) return;
        var dayStartString = date + " 00:00:00";
        var dayEndString = date + " 23:59:59";
        var dayStart = (new Date((dayStartString).replace(/-/g,"/")).getTime()) / 1000;
        var dayEnd = (new Date((dayEndString).replace(/-/g,"/")).getTime()) / 1000;
        dateAxis.setRange(dayStart, dayEnd);
      }

      function initialize() {

        // Load the classic theme
        Galleria.loadTheme('assets/galleria/themes/classic/galleria.classic.min.js');

        // Initialize Galleria
        Galleria.run('#galleria', {
            /* ACCAN user ID */
            flickr: 'user:158676524@N07',
            flickrOptions: {
                sort: 'date-taken-desc'
            }
        });

        $( "#tabs" ).tabs({
          heightStyle: "content",
          activate: function(event, ui) {
            if ($(ui.newPanel)[0].id == "tabs-2") {
              $("body, html").css("overflow", "hidden");
              if (!timelapse) {
                channelPageSetup();
                $(window).resize(function() {
                  setSizes();
                  google.maps.event.trigger(map, 'resize');
                });
              } else {
                timelapse.onresize();
              }
              setSizes();
              google.maps.event.trigger(map, 'resize');
            } else {
              $("body, html").css("overflow", "auto");
              // Hack for Chrome when switching tabs:
              // Gifs stop animating unless the page changes size
              if (tmpCount % 2 === 0)
                $("#google-doc").width("99.9%");
              else
                $("#google-doc").width("100%");
              tmpCount++;
            }
          }
        });
        if (window.location.hash.indexOf("#v=") > -1)
          $( "#tabs" ).tabs( "option", "active", 1 );
      }

      window.grapherLoad = function() {
        grapherReady = true;
      };

      $(initialize);

      function createTutorialButton(buttonWidth, buttonHeight, appendingDiv) {
        var $tutorialButton = $("<div class='tutorialButton'>Quick Tour</div>");
        $tutorialButton.attr({"id" : "timeMachine_tutorialButton", "title" : "Watch an instructional video on how to use Shenango Channel"});
        $tutorialButton.button({
          icons: {
            primary: "ui-icon-custom-tutorialButton"
          },
          text: true
        }).on("click", function() {
          var $tourDialog = $("#tutorialDialog");
          if ($tourDialog.dialog("isOpen")) {
            $tourDialog.dialog("close");
            $("#tutorialIframe").remove();
          } else {
            $("#tutorialDialog").append('<iframe id="tutorialIframe" src="//player.vimeo.com/video/140196813?autoplay=1" width="100%" height="100%" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>');
            $tourDialog.dialog("open");
          }
        });
        $tutorialButton.appendTo($(appendingDiv));

        $("#tutorialDialog").dialog({
          resizable: false,
          autoOpen: false,
          dialogClass: "customDialog",
          width: buttonWidth,
          height: buttonHeight,
          modal: true,
          open: function( event, ui ) {
            $(this).parent().css("top", "0px");
            $(".ui-widget-overlay").on('click', function(){
              $("#tutorialDialog").dialog('close');
            });
          },
          close: function( event, ui ) {
            $("#tutorialIframe").remove();
          }
        });
      }

      function channelPageSetup() {
        // Initialize E-Cam
        var timelapseSupported = org.gigapan.Util.browserSupported();
        var stitchedImage = "N/A";
        locationDivId = "shenango1" + "_overlay";
        setLocationThumbnailToggle();
        $(".location_thumbnail_container").on("click", function() {
          if (window.location.hash)
            window.location.hash = "";
          var newLocation = $(this).attr("data-location-id");
          if (timelapse)
            var captureTimeAsDateObj = new Date(timelapse.getCurrentCaptureTime().replace(/-/g,"/"));
          changeLocation(newLocation, currentDate, null, null, true, null, captureTimeAsDateObj);
        });
        if ((!timelapseSupported || typeof (cached_breathecam) === "undefined") && stitchedImage === "") {
          // Nothing is up. Hide containers and inform the user
          $("#stitched_image_wrapper").hide();
          $("#location_toggle_container").hide();
          $("#loading").html("<div class='error_msg2'>Content currently unavailable. Please try again later.</div>");
        } else if (!timelapseSupported || typeof (cached_breathecam) === "undefined") {
          timelapseFeedUnavailable = true;
          // TODO: Image feed is not working since the-shenango-channel currently does not have a way to get the latest image,
          // unlike when it was running on the Rails server.
          // Timelapse unavailable, show latest stitched pano
          // Calendar is gone in this mode, so move thumbnail toggles to top of page
          //$("#location_toggle").css({'top':'0px'});
          //$("#image_feed_timestamp").css({"top" : "48px", "right" : "22px"});
          //img_init();
          $("#stitched_image_wrapper").hide();
          $("#location_toggle_container").hide();
          $("#timelapse_feed").hide();
          $("#grapher").hide();
          $("#map-canvas").hide();
          $("#tutorialDialog").hide();
          $("#loading").html("<div class='error_msg2'>Shenango Channel is not available on mobile devices. Please use a desktop or laptop when viewing this site.</div>");
        } else {
          // Show timelapse
          tm_init();
        }

        // Initialize Map
        initMap('map-canvas');

        grapherLoadedInterval = window.setInterval(function() {
          if (!grapherReady) return;

          window.clearInterval(grapherLoadedInterval);
          grapherLoadedInterval = null;

          // Initialize Smells
          initSmells();

          // Initialize Graphs
          var feedNames = Object.keys(esdr_feeds).sort();
          if(showSmokeDetection) {
            feedNames.splice(feedNames.indexOf("Smoke_Detection"), 1);
            feedNames[feedNames.length] = "Smoke_Detection";
          }
          for (var i = 0; i < feedNames.length; i++) {
            (function(i){
              $.ajax({
                type: "GET",
                dataType: "json",
                url: ESDR_API_ROOT_URL + '/feeds/' + esdr_feeds[feedNames[i]].api_key,
                success: function(json) {
                  esdr_feeds[feedNames[i]].fullTimeRange.min = json.data.minTimeSecs;
                  esdr_feeds[feedNames[i]].fullTimeRange.max = json.data.maxTimeSecs;
                  if (i == feedNames.length - 1) {
                    for (var j = 0; j < feedNames.length; j++) {
                      (function(j){
                        var feed = esdr_feeds[feedNames[j]];
                        var channelNames = Object.keys(feed.channels);
                        channelNames.forEach(function(channelName) {
                          if (!feed.channels[channelName].show_graph) return;
                          window.setTimeout(function() {
                            createChart(feed, channelName, feed.api_key);
                          }, j*50);
                        });
                      })(j);
                    }
                  }
                }
              });
            })(i);
          }
        }, 10);
      }

      window.requestAnim =
        window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(callback) {
          return window.setTimeout(callback, 10);
        };

    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-10682694-14', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
  <body style="height: 100%">
    <div id="tabs" style="width: 100%; height: 100%; margin: 0; padding: 0px; position: absolute;">
      <ul>
        <li><a href="#tabs-1" style="outline:0;">Introduction by ACCAN</a></li>
        <li><a href="#tabs-2" style="outline:0;">Shenango Channel Archive</a></li>
        <li><a href="#tabs-3" style="outline:0;">Road to Revitalization</a></li>
      </ul>
      <div id="tabs-1" style="width: 100%; padding: 0px; margin: 0;">
        <iframe id="google-doc" src="http://shenangochannel.org/google-docs.php" width="100%" height="1200px" style="border: 0px;"></iframe>
      </div>
      <div id="tabs-2" style="width: 100%; height: 100%; margin: 0; padding: 0px">
        <div id="foo" style="height: calc(100% - 35px)">
          <div id="container">
            <div id="loading">
              <img id="loadingImg" src="assets/images/loading.gif" width="358" height="250" alt="loading">
            </div>
            <div id="tutorialDialog" title="A Tour for the Shenango Channel"></div>
            <div id="locationTitle" class="no-select"></div>
            <div id="timelapse_feed" class="timelapse_feed_embed">
              <div id="timeMachine"></div>
              <div id="datepicker" class="datepicker_embed no-select"></div>
            </div>
            <div id="image_feed" class="image_feed_embed no-select">
              <div id="stitched_image_wrapper" class="image-zoom-wrapper image-zoom-wrapper-embed">
                <div id="zoom-in" title="Zoom in"><p>+</p></div>
                <div id="zoom-out" title="Zoom out"><p>_</p></div>
                <img id="stitched_image" class="image-zoom" src="#" alt="Latest Stitch">
                <span id="image_feed_timestamp">03/09/2015 03:16 PM</span>
              </div>
            </div>
            <div id="location_toggle_container" class="no-select">
              <a class="location_thumbnail_container" data-location-id="shenango1" href="javascript:void(0)">
                <div id="shenango1_overlay" class="location_thumbnail_overlay"></div>
                <img src="assets/images/shenango1.png" class="location_thumbnail" alt="Shenango1">
                <div class="location_title">ACCAN Camera (Avalon)</div>
              </a>
              <a class="location_thumbnail_container location_thumbnail_container_end" data-location-id="shenango2" href="javascript:void(0)">
                <div id="shenango2_overlay" class="location_thumbnail_overlay"></div>
                <img src="assets/images/shenango2.png" class="location_thumbnail" alt="Shenango2">
                <div class="location_title">ACHD Camera (Bellevue)</div>
              </a>
            </div>
          </div>
          <div id="grapher_parent" style="width:50%; height:50%; float: left"><table id="grapher" border="0" cellspacing="0" cellpadding="0"></table></div>
          <div style="width:50%; height:50%; float: right"><div id="map-canvas"></div></div>
          </div>
      </div>
      <div id="tabs-3" style="width: 100%; height: 90%; padding: 0px; margin: 0;">
        <h1 id="tab3-header">The Road to Revitalization</h1>
        <p id="tab3-intro-text">
          ACCAN remains concerned about how DTE Energy clears and remediates the Shenango Coke Works sites, since these activities can release pollutants into the air and water.
          The Coke Works buildings contain asbestos and the soil contains still to be identified pollutants.  Posting these post closure photos on this channel is one way that we
          continue to monitor activities on the site.
        </p>
        <div id="galleria" style="width: 100%; height: 550px"></div>
      </div>
    </div>
    <div style="font-family: Custom-Calibri;">.</div>
  </body>
</html>
